# ==============================================================================
# EC-Platform Environment Variables
# Copy this file to .env and update the values
# ==============================================================================

# ------------------------------------------------------------------------------
# Application
# ------------------------------------------------------------------------------
APP_ENV=development
LOG_LEVEL=debug

# ------------------------------------------------------------------------------
# BFF Service (Connect-go)
# ------------------------------------------------------------------------------
BFF_HOST=0.0.0.0
BFF_PORT=8080
BFF_READ_TIMEOUT=30s
BFF_WRITE_TIMEOUT=30s

# CORS Configuration
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5173
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=Content-Type,Authorization,Connect-Protocol-Version,Connect-Timeout-Ms,Idempotency-Key

# ------------------------------------------------------------------------------
# gRPC Backend Services
# ------------------------------------------------------------------------------
USER_SERVICE_ADDR=localhost:50051
PRODUCT_SERVICE_ADDR=localhost:50052
ORDER_SERVICE_ADDR=localhost:50053

# ------------------------------------------------------------------------------
# User Service
# ------------------------------------------------------------------------------
USER_SERVICE_HOST=0.0.0.0
USER_SERVICE_PORT=50051

# ------------------------------------------------------------------------------
# Product Service
# ------------------------------------------------------------------------------
PRODUCT_SERVICE_HOST=0.0.0.0
PRODUCT_SERVICE_PORT=50052

# ------------------------------------------------------------------------------
# Order Service
# ------------------------------------------------------------------------------
ORDER_SERVICE_HOST=0.0.0.0
ORDER_SERVICE_PORT=50053

# ------------------------------------------------------------------------------
# PostgreSQL
# ------------------------------------------------------------------------------
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=ecplatform
POSTGRES_PASSWORD=ecplatform_secret
POSTGRES_DB=ecplatform

# Connection string format
DATABASE_URL=postgres://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}?sslmode=disable

# Connection pool settings
POSTGRES_MAX_CONNS=10
POSTGRES_MIN_CONNS=2
POSTGRES_MAX_CONN_LIFETIME=1h
POSTGRES_MAX_CONN_IDLE_TIME=30m

# ------------------------------------------------------------------------------
# Redis
# ------------------------------------------------------------------------------
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# Redis URL format
REDIS_URL=redis://${REDIS_HOST}:${REDIS_PORT}/${REDIS_DB}

# JWKS Cache settings
JWKS_CACHE_TTL=15m
IDEMPOTENCY_KEY_TTL=24h

# ------------------------------------------------------------------------------
# Ory Hydra (OAuth2/OIDC)
# ------------------------------------------------------------------------------
HYDRA_PUBLIC_URL=http://localhost:4444
HYDRA_ADMIN_URL=http://localhost:4445

# JWKS endpoint for JWT verification
HYDRA_JWKS_URL=${HYDRA_PUBLIC_URL}/.well-known/jwks.json

# JWT Configuration
JWT_ISSUER=http://localhost:4444
JWT_ACCESS_TOKEN_LIFESPAN=15m
JWT_REFRESH_TOKEN_LIFESPAN=168h

# OAuth2 Client (created via hydra CLI)
OAUTH2_CLIENT_ID=ec-platform-spa
OAUTH2_CLIENT_SECRET=

# ------------------------------------------------------------------------------
# OpenTelemetry (Phase 1.5)
# ------------------------------------------------------------------------------
OTEL_ENABLED=false
OTEL_SERVICE_NAME=ec-platform
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317

# ------------------------------------------------------------------------------
# Security
# ------------------------------------------------------------------------------
# CSRF Token secret (generate with: openssl rand -hex 32)
CSRF_SECRET=change_me_in_production

# Session cookie settings
SESSION_COOKIE_NAME=ec_session
SESSION_COOKIE_SECURE=false
SESSION_COOKIE_HTTP_ONLY=true
SESSION_COOKIE_SAME_SITE=lax
